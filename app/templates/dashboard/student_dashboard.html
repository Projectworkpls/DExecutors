{% extends "base.html" %}

{% block title %}Student Dashboard - DExecutors{% endblock %}

{% block content %}
<style>
.dashboard-hero {
    text-align: center;
    margin-top: 32px;
    margin-bottom: 36px;
}
.dashboard-hero h1 {
    font-family: 'Playfair Display', serif;
    font-size: 2.6rem;
    font-weight: 700;
    margin-bottom: 10px;
    letter-spacing: 1px;
    color: #222;
}
.dashboard-hero .divider {
    width: 60px;
    margin: 16px auto 20px auto;
    border: 0;
    border-top: 3px solid #7f53ac;
    border-radius: 2px;
}
.dashboard-hero p {
    max-width: 650px;
    margin: 0 auto;
    color: #555;
    font-size: 1.13rem;
    line-height: 1.6;
}

/* Container for the two cards side by side */
.dashboard-cards-row {
    display: flex;
    justify-content: space-between;
    gap: 32px;
    max-width: 1200px;
    margin: 36px auto 24px auto;
    padding: 0 20px;
    flex-wrap: wrap;
}

/* Each card takes about 48% width on desktop */
.dashboard-card {
    background: #fff;
    border-radius: 18px;
    box-shadow: 0 4px 24px rgba(100,100,150,0.09);
    width: 48%;
    min-height: 420px;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0 0 24px 0;
    transition: box-shadow 0.22s, transform 0.18s;
    overflow: hidden;
    position: relative;
}
.dashboard-card:hover {
    box-shadow: 0 8px 36px rgba(127,83,172,0.16);
    transform: translateY(-6px) scale(1.03);
}
.dashboard-card .card-img {
    width: 100%;
    height: 170px;
    object-fit: cover;
    background: #f8f9fa;
    border-bottom: 1px solid #f1f1f1;
}
.dashboard-card .card-content {
    padding: 24px 30px 0 30px;
    width: 100%;
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
}
.dashboard-card h3 {
    font-size: 1.5rem;
    font-family: 'Playfair Display', serif;
    font-weight: 700;
    color: #7f53ac;
    margin: 0 0 20px 0;
    text-align: center;
}
.dashboard-card .card-list {
    width: 100%;
    margin: 0;
    padding: 0;
    list-style: none;
}
.dashboard-card .card-list .project-item {
    margin-bottom: 18px;
    text-align: left;
    border-bottom: 1px solid #f3f3f3;
    padding-bottom: 12px;
}
.dashboard-card .card-list .project-item:last-child {
    border-bottom: none;
    margin-bottom: 0;
}
.dashboard-card .project-title {
    font-size: 1.12rem;
    font-weight: 600;
    color: #2d3a60;
    margin: 0 0 6px 0;
}
.dashboard-card .project-meta {
    font-size: 1rem;
    color: #4a5a7a;
    display: flex;
    gap: 14px;
    margin-bottom: 6px;
    flex-wrap: wrap;
}
.dashboard-card .status {
    border-radius: 5px;
    padding: 2px 10px;
    font-size: 0.97rem;
    font-weight: 500;
}
.status-pending, .status-applied { background: #fffbe6; color: #b09500; }
.status-approved, .status-submitted { background: #e6f9e8; color: #217a3a; }
.status-rejected { background: #ffeaea; color: #b12e2e; }
.dashboard-card .btn-small {
    margin-top: 8px;
    font-size: 0.97rem;
    padding: 6px 18px;
    border-radius: 6px;
    background: #e7efff;
    color: #2357d5;
    border: none;
    text-decoration: none;
    font-weight: 600;
    transition: background 0.18s;
    display: inline-block;
}
.dashboard-card .btn-small:hover {
    background: #d2e2ff;
}
.dashboard-card .empty-state {
    margin: 24px 0 0 0;
    color: #888;
    text-align: center;
    font-size: 1.09rem;
}
.dashboard-card .empty-state p {
    margin-bottom: 16px;
    font-weight: 500;
}
.dashboard-card .budget {
    background: #f5f8ff;
    color: #7f53ac;
    font-weight: 600;
    border-radius: 8px;
    padding: 3px 10px;
    font-size: 0.97rem;
}
.dashboard-card .ai-score {
    background: #e3f1fc;
    color: #1976d2;
    border-radius: 6px;
    padding: 2px 10px;
    font-size: 0.97rem;
    margin-left: 6px;
}

/* Container for the single "View All Opportunities" button */
.view-all-container {
    max-width: 1200px;
    margin: 0 auto 60px auto;
    padding: 0 20px;
    text-align: center;
}

.view-all-btn {
    display: inline-block;
    padding: 16px 48px;
    font-size: 1.25rem;
    font-weight: 700;
    color: #fff;
    background: linear-gradient(90deg, #7f53ac, #647dee);
    border: none;
    border-radius: 30px;
    cursor: pointer;
    box-shadow: 0 6px 20px rgba(127,83,172,0.25);
    transition: background 0.3s ease, box-shadow 0.3s ease, transform 0.15s ease;
    text-decoration: none;
}

.view-all-btn:hover,
.view-all-btn:focus {
    background: linear-gradient(90deg, #647dee, #7f53ac);
    box-shadow: 0 8px 28px rgba(127,83,172,0.35);
    transform: translateY(-3px) scale(1.05);
    outline: none;
}

/* Responsive adjustments */
@media (max-width: 1100px) {
    .dashboard-card {
        width: 100%;
        min-height: auto;
    }
    .dashboard-cards-row {
        flex-direction: column;
        gap: 32px;
        padding: 0 12px;
    }
    .view-all-container {
        padding: 0 12px;
    }
}
</style>

<div class="dashboard-hero">
    <h1>Welcome, {{ user.username if user else 'Student' }}</h1>
    <hr class="divider">
    <p>
        Track your journey, submit new ideas, apply to projects, and discover fresh opportunities ‚Äî all in one place!
        <br>
        <span style="color:#7f53ac;font-weight:600;">
            Level {{ user.level if user else 1 }} &middot; {{ user.reputation_xp if user else 0 }} XP
        </span>
    </p>
</div>

<div class="dashboard-cards-row">
    <!-- My Submissions Card -->
    <div class="dashboard-card">
        <img src="{{ url_for('static', filename='img/submissions.jpg') }}" alt="My Submissions" class="card-img">
        <div class="card-content">
            <h3>üì§ My Submissions</h3>
            {% if my_submissions %}
            <ul class="card-list">
                {% for submission in my_submissions[:3] %}
                <li class="project-item">
                    <div class="project-title">{{ submission.title or submission.project_title }}</div>
                    <div class="project-meta">
                        <span class="status status-{{ submission.status|lower }}">{{ submission.status|capitalize }}</span>
                        <span>
                            Submitted: 
                            {% if submission.submitted_at %}
                                {{ submission.submitted_at|date('d M Y') }}
                            {% else %}
                                N/A
                            {% endif %}
                        </span>
                    </div>
                    <a href="{{ url_for('students.submission_analysis', submission_id=submission.id) }}" class="btn-small">View</a>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <div class="empty-state">
                <p>No submissions yet.</p>
                <a href="{{ url_for('students.submit_idea') }}" class="btn-small">Submit your first idea!</a>
            </div>
            {% endif %}
        </div>
    </div>

<!-- My Project Applications Card -->
<div class="dashboard-card">
    <img src="{{ url_for('static', filename='img/applications.jpg') }}" alt="My Project Applications" class="card-img">
    <div class="card-content">
        <h3>üìù My Project Applications</h3>
        {% if my_applications %}
        <ul class="card-list">
            {% for app in my_applications[:3] %}
            <li class="project-item">
                <div class="project-title">{{ app.project_title }}</div>
                <div class="project-meta">
                    <span class="status status-{{ app.application_status|lower }}">{{ app.application_status|capitalize }}</span>
                    <span class="status status-{{ app.submission_status|lower }}">{{ app.submission_status|capitalize }}</span>
                </div>
                {% if not app.submitted %}
                    <a href="{{ url_for('students.submit_project', application_id=app.id) }}" class="btn-small">Submit Project</a>
                {% else %}
                    <a href="{{ url_for('students.view_submission', submission_id=app.submission_id) }}" class="btn-small">View Submission</a>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <div class="empty-state">
            <p>No project applications yet.</p>
            <a href="{{ url_for('students.submit_project') }}" class="btn-small">Add Project Application</a>
        </div>
        {% endif %}
    </div>
</div>


<!-- View All Opportunities Button -->
<div class="view-all-container">
    <a href="{{ url_for('students.browse_projects') }}" class="view-all-btn" aria-label="View all opportunities">View All Opportunities</a>
</div>

{% endblock %}
